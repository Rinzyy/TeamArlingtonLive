{% extends "base.html" %}
{% block content %}
<div class="form-container">
  <div class="form-header">
    <h1>âœ… Approver Dashboard</h1>
    <p>University of Houston - Approval Management</p>
  </div>

  <div class="form-section">
    <h3>ğŸ” Filter Requests</h3>
    <form method="get" style="display: flex; gap: 15px; align-items: end; flex-wrap: wrap;">
      <div class="form-group" style="margin: 0; flex: 1; min-width: 200px;">
        <label>State:</label>
        <select name="state" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
          <option value="">(show pending by default)</option>
          {% for s in ['pending','returned','approved','rejected'] %}
          <option value="{{ s }}" {{ 'selected' if request.args.get('state')==s else '' }}>{{ s|upper }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="form-group" style="margin: 0; flex: 1; min-width: 200px;">
        <label>Search:</label>
        <input type="text" name="q" value="{{ request.args.get('q','') }}" placeholder="Student name, form..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
      </div>
      <button type="submit" class="btn btn-primary" style="margin: 0;">ğŸ” Filter</button>
    </form>
  </div>

  <div class="form-section">
    <h3>ğŸ“‹ Pending Requests</h3>
    <table border="1" cellpadding="12" cellspacing="0" width="100%" style="background: white; border-radius: 4px; overflow: hidden;">
  <thead>
    <tr>
      <th>#</th><th>Student</th><th>Form</th><th>Step</th><th>Req. 
State</th><th>Updated</th><th>Open</th>
    </tr>
  </thead>
  <tbody>
    {% for r in requests %}
    <tr>
      <td>{{ r.id }}</td>
      <td>{{ r.student_name }}</td>
      <td>{{ r.form_name }}</td>
      <td>{{ r.step_number }} ({{ r.step_status }})</td>
      <td>{{ r.state }}</td>
      <td>{{ r.updated_at }}</td>
      <td><a href="{{ url_for('approvals_bp.approver_request_detail', 
request_id=r.id) }}">Open â€º</a></td>
    </tr>
    {% else %}
    <tr><td colspan="7"><em>No requests found.</em></td></tr>
    {% endfor %}
  </tbody>
</table>
  </div>
</div>
{% endblock %}

